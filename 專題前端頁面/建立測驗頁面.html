<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>測驗建立</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background-color: #f9f9f9;
      padding: 20px;
    }
    h2 {
      margin-bottom: 20px;
    }
    .section {
      border: 2px solid #d0d6dc;
      border-radius: 10px;
      background-color: white;
      padding: 20px;
      margin-bottom: 30px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 8px;
      color: #333;
    }
    select, input[type="number"], input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .form-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .option-item {
      min-width: 150px;
    }
    .btn {
      background-color: #d67b7b;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }
    .btn:hover {
      background-color: #c06565;
    }
    .form-row {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .form-row .form-group {
      flex: 1;
      min-width: 200px;
    }
  </style>
</head>
<body>
  <div id="app">
    <h2>測驗建立</h2>

    <div class="section">
      <div class="form-row">
        <div class="form-group">
          <label><h3>選擇主題</h3></label>
          <select v-model="selectedTopic">
            <option disabled value="">請選擇一個主題</option>
            <option v-for="topic in topics" :key="topic">{{ topic }}</option>
          </select>
        </div>

        <div class="form-group">
          <label><h3>選擇觀念</h3></label>
          <select v-model="selectedConcept">
            <option disabled value="">請選擇一個觀念</option>
            <option v-for="concept in concepts" :key="concept">{{ concept }}</option>
          </select>
        </div>

        <div class="form-group">
          <label><h3>難易度</h3></label>
          <select v-model="selectedDifficulty">
            <option v-for="level in difficulties" :key="level">{{ level }}</option>
          </select>
        </div>

        <div class="form-group">
          <label><h3>題數</h3></label>
          <select v-model="selectedCount">
            <option v-for="count in questionCounts" :key="count">{{ count }}</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label><h3>計時方式</h3></label>
        <div class="form-options" style="align-items: center;height: 50px;">
          <label class="option-item" v-for="option in timingOptions" :key="option.value">
            <input type="radio" name="timing" :value="option.value" v-model="selectedTiming" />
            {{ option.label }}
          </label>
          <label class="option-item" v-if="selectedTiming === 'custom'">
            <input type="number" v-model="customTime" placeholder="例如：30(分鐘)" style="width: 150px;">
          </label>
        </div>
      </div>

      <div class="form-group">
        <label><h3>題型</h3></label>
        <div class="form-options">
          <label class="option-item" v-for="type in questionTypes" :key="type.value">
            <input type="checkbox" :value="type.value" v-model="selectedQuestionTypes" />
            {{ type.label }}
          </label>
        </div>
      </div>

      <div class="form-group">
        <button class="btn" @click="createQuiz">建立測驗</button>
      </div>
    </div>
  </div>

  <script>
    //這裡開始是vue.js
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          topics: ['主題01', '主題02', '主題03', '主題04', '主題05'],
          allConcepts: {
            '主題01': ['觀念01-A', '觀念01-B'],
            '主題02': ['觀念02-A', '觀念02-B', '觀念02-C'],
            '主題03': ['觀念03-A'],
            '主題04': ['觀念04-A', '觀念04-B'],
            '主題05': ['觀念05-A', '觀念05-B', '觀念05-C']
          },
          difficulties: ['系統自動', '平均分配', '容易', '中等', '困難', '魔王'],
          questionCounts: ['5 題', '10 題', '20 題', '25 題'],
          timingOptions: [
            { label: '系統建議', value: 'auto' },
            { label: '正向計時', value: 'forward' },
            { label: '倒數計時', value: 'countdown' },
            { label: '自訂倒數計時', value: 'custom' }
          ],
          questionTypes: [
            { label: '單選題', value: 'single' },
            { label: '多選題', value: 'multiple' },
            { label: '選填題', value: 'fill-in' },
            { label: '非選題', value: 'essay' },
            { label: '平均分配', value: 'average' },
            { label: '系統自動', value: 'auto' }
          ],

          // 綁定資料
          selectedTopic: '',
          selectedConcept: '',
          selectedDifficulty: '系統自動',
          selectedCount: '5 題',
          selectedTiming: 'auto',
          customTime: '',
          selectedQuestionTypes: []
        };
      },
      computed: {
        concepts() {
          return this.selectedTopic ? this.allConcepts[this.selectedTopic] : [];
        }
      },
      watch: {
        selectedTopic() {
          this.selectedConcept = '';
        }
      },
      methods: {
        createQuiz() {
          const payload = {
            topic: this.selectedTopic,
            concept: this.selectedConcept,
            difficulty: this.selectedDifficulty,
            count: this.selectedCount,
            timing: this.selectedTiming === 'custom' ? `custom-${this.customTime}` : this.selectedTiming,
            questionTypes: this.selectedQuestionTypes
          };
          console.log('測驗資料:', payload);

          // 與後端 Express 整合時可使用這段：
          // fetch('/api/quiz/create', {
          //   method: 'POST',
          //   headers: { 'Content-Type': 'application/json' },
          //   body: JSON.stringify(payload)
          // }).then(res => res.json()).then(result => {
          //   console.log(result);
          // });
        }
      }
    }).mount('#app');
  </script>
</body>
</html>
